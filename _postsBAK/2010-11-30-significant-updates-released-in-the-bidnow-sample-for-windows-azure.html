--- 
layout: post
title: Significant Updates Released in the BidNow Sample for Windows Azure
categories: 
- Access Control
- Caching
- OData
- Windows Azure
- Windows Azure AppFabric
- Windows Azure Platform
- Windows Identity Foundation
- Windows Phone 7
tags: []

status: publish
type: post
published: true
meta: 
  dsq_thread_id: "609465409"
---
<p>Click here if you want to quickly grab the <a href="http://code.msdn.microsoft.com/BidNowSample/Release/ProjectReleases.aspx?ReleaseId=4160" target="_blank">latest version of the BidNow sample</a>.&#160; Click here if you want to see a <a href="http://bnow-sample.cloudapp.net/" target="_blank">live demo of the application</a>.</p>  <p><img style="border-right-width: 0px; margin: 0px 0px 0px 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="BidNowSample" border="0" alt="BidNowSample" align="right" src="http://images.wadewegner.com/wordpress/2010/11/BidNowSample.png" width="240" height="230" /> There have been a host of announcements and releases over the last month for the Windows Azure Platform.&#160; It started at the <a href="http://microsoftpdc.com/" target="_blank">Professional Developers Conference (PDC)</a> in Redmond, where we announced new services such as <a href="http://www.wadewegner.com/2010/10/new-services-and-enhancements-with-the-windows-azure-appfabric/" target="_blank">Windows Azure AppFabric Caching</a> and <a href="http://www.microsoft.com/en-us/sqlazure/reporting.aspx" target="_blank">SQL Azure Reporting</a>, as well as new features for Windows Azure, such as VM Role, Admin mode, RDP, Full IIS, and a new portal experience.&#160; Yesterday, the Windows Azure team released the <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=7a1089b6-4050-4307-86c4-9dadaa5ed018&amp;displaylang=en" target="_blank">Windows Azure SDK 1.3 and Tools for Visual Studio</a> and updates to the <a href="http://windows.azure.com/" target="_blank">Windows Azure portal</a> (for all the details, see the <a href="http://blogs.msdn.com/b/windowsazure/archive/2010/11/29/just-released-windows-azure-sdk-1-3-and-the-new-windows-azure-management-portal.aspx" target="_blank">team post</a>).&#160; These are significant releases that provide a lot of enhancements for Windows Azure.</p>  <p>One of the difficulties that come with this many updates in a short period of time is keeping up with the changes and updates.&#160; It can be challenging to understand how these features and capabilities come together to help you build better web applications.</p>  <p>This is why my team has released sample applications like <a href="http://code.msdn.microsoft.com/BidNowSample" target="_blank">BidNow</a>, <a href="http://code.msdn.microsoft.com/fshipsaassource" target="_blank">FabrikamShipping SaaS</a>, and <a href="http://code.msdn.microsoft.com/mytodo" target="_blank">myTODO</a>.</p>  <p><strong><u>What’s in the BidNow Sample?</u></strong></p>  <p>Just today I posted the <a href="http://code.msdn.microsoft.com/BidNowSample/Release/ProjectReleases.aspx?ReleaseId=4160" target="_blank">latest version of BidNow on the MSDN Code Gallery</a>.&#160; BidNow has been significantly updated to leverage many pieces of the Windows Azure Platform, including many of the new features and capabilities announced at PDC and that are a part of the Windows Azure SDK 1.3.&#160; This list includes:</p>  <ul>   <li>Windows Azure <strong>(updated)</strong>       <ul>       <li>Updated for the Windows Azure SDK 1.3 </li>        <li>Separated the Web and Services tier into two web roles </li>        <li>Leverages Startup Tasks to register certificates in the web roles </li>        <li>Updated the worker role for asynchronous processing </li>     </ul>   </li>    <li>SQL Azure<strong> (new)</strong>       <ul>       <li>Moved data out of Windows Azure storage and into SQL Azure (e.g. categories, auctions, buds, and users) </li>        <li>Updated the DAL to leverage Entity Framework 4.0 with appropriate data entities and sources </li>        <li>Included a number of scripts to refresh and update the underlying data </li>     </ul>   </li>    <li>Windows Azure storage<strong> (update)</strong>       <ul>       <li>Blob storage only used for auction images and thumbnails </li>        <li>Queues allow for asynchronous processing of auction data </li>     </ul>   </li>    <li>Windows Azure AppFabric Caching <strong>(new)</strong>       <ul>       <li>Leveraging the Caching service to cache reference and activity data stored in SQL Azure </li>        <li>Using local cache for extremely low latency </li>     </ul>   </li>    <li>Windows Azure AppFabric Access Control <strong>(new)</strong>       <ul>       <li>BidNow.Web leverages WS-Federation and Windows Identity Foundation to interact with Access Control </li>        <li>Configured BidNow to leverage Live ID, Yahoo!, and Facebook by default </li>        <li>Claims from ACs are processed by the <em>ClaimsAuthenticationManager</em> such that they are enriched by additional profile data stored in SQL Azure </li>     </ul>   </li>    <li>OData<strong> (new)</strong>       <ul>       <li>A set of OData services (i.e. WCF Data Services) provide an independent services layer to expose data to difference clients </li>        <li>The OData services are secured using Access Control </li>     </ul>   </li>    <li>Windows Phone 7&#160; <strong>(new)</strong>       <ul>       <li>A Windows Phone 7 client exists that consumes the OData services </li>        <li>The Windows Phone 7 client leverages Access Control to access the OData services </li>     </ul>   </li> </ul>  <p>Yes, there are a lot of pieces to this sample, but I think you’ll find that it mimics many real world applications.&#160; We use Windows Azure web and worker roles to host our application, Windows Azure storage for blobs and queues, SQL Azure for our relational data, AppFabric Caching for reference and activity data, Access Control for authentication and authorization, OData for read-only services, and a Windows Phone 7 client that consumes the OData services.&#160; That’s right - in addition to the Windows Azure Platform pieces, we included a set of OData services that are leveraged by a Windows Phone 7 client authenticated through Access Control.</p>  <p><strong><u>High Level Architecture</u></strong></p>  <p>Here’s a high level look at the application architecture:</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.wadewegner.com/wordpress/2010/11/image7.png" width="626" height="409" /> </p>  <p><strong>Compute</strong>: BidNow consists of three distinct Windows Azure roles – a web role for the website, a web role for the services, and a worker role for long running operations.&#160; The BidNow.Web web role hosts Web Forms that interact with the underlying services through a set of WCF Service clients.&#160; These services are hosted in the BidNow.Services.Web web role.&#160; The worker role, BidNow.Worker, is in charge of handling the long running operations that could hurt the websites performance (e.g. image processing).</p>  <p><strong>Storage</strong>: BidNow uses three different types of storage.&#160; There’s a relational database, hosted in SQL Azure, that contains all the auction information (e.g. categories, auctions, and bids) and basic user information, such as Name and Email address (note that user credentials are not stored in BidNow, as we use Access Control to abstract authentication).&#160; We use Windows Azure Blob storage to store all the auction images (e.g. the thumbnail and full image of the products), and Windows Azure Queues to dispatch asynchronous operations.&#160; Finally, BidNow uses Windows Azure AppFabric Caching to store reference and activity data used by the web tier.&#160; </p>  <p><strong>Authentication &amp; Authorization</strong>: In BidNow, users are allowed to navigate through the site without any access restrictions.&#160; However, to bid on or publish an item, authentication is required.&#160; BidNow leverages the identity abstraction and federation aspects of Windows Azure AppFabric Access Control&#160; to validate the users identity against different identity providers – by default, BidNow leverages Windows Live Id, Facebook, and Yahoo!.&#160; BidNow uses Windows Identity Foundation to process identity tokens received from Access Control, and then leverages claims from within those tokens to authenticate and authorize the user.</p>  <p><strong>Windows Phone 7</strong>: In today’s world it’s a certainty that your website will have mobile users.&#160; Often, to enrich the experience, client applications are written for these devices.&#160; The BidNow sample also includes a Windows Phone 7 client that interacts with a set of OData services that run within the web tier.&#160; This sample demonstrates how to build a Windows Phone 7 client that leverages Windows Azure, OData, and Access Control to extend your application.</p>  <p>Of course, there’s a lot more that you’ll discover one you dig in.&#160; Over the next few weeks, I’ll write and record a series of blog posts and web casts that explore BidNow in greater depth.</p>  <p><strong><u>Getting Started</u></strong></p>  <p>To get started using BidNow, be sure you have the following prerequisites installed:</p>  <ul>   <li>Windows 7, Vista SP1 or Windows Server 2008 </li>    <li>Windows PowerShell </li>    <li><a href="http://go.microsoft.com/fwlink/?LinkID=128752" target="_blank">Windows Azure Software Development Kit 1.3</a> </li>    <li><a href="http://go.microsoft.com/fwlink/?LinkID=184288" target="_blank">Windows Azure AppFabric SDK 2.0</a> </li>    <li>Internet Information Services 7.0 (or greater) </li>    <li><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=9CFB2D51-5FF4-4491-B0E5-B386F32C0992" target="_blank">Microsoft .NET Framework 4</a> </li>    <li><a href="http://www.microsoft.com/express/Database/InstallOptions.aspx" target="_blank">Microsoft SQL Express 200</a>8 </li>    <li><a href="http://go.microsoft.com/?linkid=7653519" target="_blank">Microsoft Visual Web Developer 2010 Express</a>, or <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=26bae65f-b0df-4081-ae6e-1d828993d4d0" target="_blank">Microsoft Visual Studio 2010</a> </li>    <li><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=EB9C345F-E830-40B8-A5FE-AE7A864C4D76" target="_blank">Windows Identity Foundation Runtime</a> </li>    <li><a href="http://www.microsoft.com/downloads/details.aspx?familyid=C148B2DF-C7AF-46BB-9162-2C9422208504" target="_blank">Windows Identity Foundation SDK 4.0</a> </li> </ul>  <p>As you’ve come to expect, BidNow includes a Configuration Wizard that includes a Dependency Checker (for all the items listed immediately above) and a number of Setup Script you can walk through to configure BidNow.&#160; At the conclusion of the wizard you can literally hit F5 and go.</p>  <p><a href="http://images.wadewegner.com/wordpress/2010/11/image8.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://images.wadewegner.com/wordpress/2010/11/image_thumb3.png" width="459" height="302" /></a> </p>  <p>Of course, don’t forget to <a href="http://code.msdn.microsoft.com/BidNowSample/Release/ProjectReleases.aspx?ReleaseId=4160" target="_blank">download the BidNow Sample</a>.&#160; For a detailed walkthrough on how to get started with BidNow, please see the <a href="http://code.msdn.microsoft.com/BidNowSample/Wiki/View.aspx?title=Getting%20Started%20with%20BidNow" target="_blank">Getting Started with BidNow wiki page</a>.</p>
