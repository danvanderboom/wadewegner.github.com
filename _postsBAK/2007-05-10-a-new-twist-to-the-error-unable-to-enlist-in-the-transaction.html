--- 
layout: post
title: "A new twist to the error: \"Unable to enlist in the transaction.\""
categories: 
- BizTalk Server
- Windows Server 2003
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/bgYXXG
  _sexybookmarks_permaHash: f99e3ab29207e2fdde06c6de3a00ba75
  dsq_thread_id: "609464822"
---
<p>I learned a new twist to the following error message today:</p>
<blockquote dir=ltr style="MARGIN-RIGHT: 0px">
<p>The adapter "SQL" raised an error message. Details "Unable to enlist in the transaction. (Exception from HRESULT: 0x8004D00A)".</p></blockquote>
<p>This can occur in a scenario where your BizTalk server attempts to connect to a separate SQL Server database and execute a distributed transaction.&nbsp; In order for this to work the BizTalk server must have the ability to "hand-off" the transaction to SQL Server.&nbsp; Typically, when you receive this error, it's because the Distributed Transaction Coordinator (DTC) service is disabled or network DTC access is disabled.&nbsp; These are the default settings in Windows Server 2003.&nbsp; Take a look at the following article:</p>
<blockquote dir=ltr style="MARGIN-RIGHT: 0px">
<p><a href="http://support.microsoft.com/?kbid=816701">http://support.microsoft.com/?kbid=816701</a></p></blockquote>
<p>There's an additional twist to this scenario.&nbsp; I found myself in a situation where I was receiving this error but had DTC setup correctly on all the machines in my BizTalk group and SQL Server cluster.&nbsp; Nevertheless, the distributed transactions failed.&nbsp; Then I found the following article:</p>
<blockquote dir=ltr style="MARGIN-RIGHT: 0px">
<p><a href="http://msdn2.microsoft.com/en-us/library/aa561924.aspx">http://msdn2.microsoft.com/en-us/library/aa561924.aspx</a> </p></blockquote>
<p>Turns out that, in order for DTC to work, the SQL Server must be able to resolve the NetBios name of the client (the BizTalk servers, in this case).&nbsp; If it cannot resolve the NetBios name the transaction will fail.&nbsp; In my environment, a firewall prevented the ability to resolve the NetBios name to an IP address thereby preventing the distributed transaction from processing.</p>
<p>To resolve this, I updated the HOST files on the SQL Server cluster so that&nbsp;they were able to resolve the NetBios names to an IP address.&nbsp; Literally, moments after saving the HOST file, all my records started getting written into the database.</p>
<p>As I&nbsp;said, a different twist to a common problem.</p>
<p>I hope this helps!</p>
