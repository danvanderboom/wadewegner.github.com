--- 
layout: post
title: Converting the Commerce Server 2007 MOM 2005 Pack for OpsMgr 2007
categories: 
- Commerce Server
- MOM 2005
- OpsMgr 2007
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/cIfBiq
  _sexybookmarks_permaHash: b9562f73fcb159b5114a6a740f57f1e7
  dsq_thread_id: "986405403"
---
<p><em>Note: For those of you that want to skip the explanation, and simply get a converted management pack for Commerce Server 2007, scroll down to download a MOM 2005 pack converted for OpsMgr 2007 for Commerce Server 2007.</em></p> <p>I previously blogged about <a href="http://www.wadewegner.com/2007/09/16/CommerceServer2007AndOperationalMonitoring.aspx">Commerce Server 2007 and Operational Monitoring</a>, and indicated that there is no native OpsMgr 2007 pack for Commerce Server 2007 (although there will be one some day).&nbsp; For now, we have to convert the MOM 2005 pack.&nbsp; Fortunately, this is a pretty straightforward process, although there is the potential for things to to fail (learn from my experience!).</p> <p>In order to convert management packs from MOM 2005 to OpsMgr 2007, you must have the following installed on your server:</p> <ul> <li><strong>Operations Manager 2007 </strong>(hopefully this is obvious)</li> <li>The <strong>MOM 2005 User Interfaces</strong> (found on your MOM 2005 disk)</li> <li>The <strong>MOM 2005 to OpsMgr 2007 Migration tool</strong> (found on your OpsMgr 2007 disk)</li></ul> <p>Now, before you go and start installing all these bits, let me share my experience.&nbsp; You <strong>should</strong> install the <strong>MOM 2005 User Interfaces</strong> first, followed by <strong>Operations Manager 2007</strong>, and lastly the <strong>MOM 2005 to OpsMgr 2007 Migration tool</strong>.&nbsp; Here's why -- when I originally attempted to convert convert the 2005 pack I started by installing OpsMgr first and then tried to install the migration tool.&nbsp; The installer told me that in order to install the migration tool I first needed the MOM 2005 UI.&nbsp; Fair enough, I thought, so I went to install the UI tool.&nbsp; However, every time the installer went to "Check Prerequisites" I got the following error:</p> <p><a href="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ConvertingtheCommerceServer2007MOMPackto_C74C/MOM2005CDError_2.gif"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="118" alt="Please verify that the CD or network share is available." src="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ConvertingtheCommerceServer2007MOMPackto_C74C/MOM2005CDError_thumb.gif" width="341" border="0"></a>&nbsp;</p> <p>No matter what I did, I got this error (although this error never occurred on any other machine that didn't have OpsMgr 2007 installed).&nbsp; I couldn't find any information on this error (evidently I'm the only person to experience this problem), but I think it's some kind of installation failure because OpsMgr 2007 was already installed.&nbsp; I went to test this theory by trying to uninstall OpsMgr 2007, but then I got a "Fatal error during installation" error when trying to uninstall.&nbsp; Ugly!</p> <p>Fortunately, this was a virtual machine so I scrapped it and started over.&nbsp; This time I installed the bits in the following order:</p> <ol> <li>The <strong>MOM 2005 User Interfaces</strong></li> <li><strong>Operations Manager 2007 </strong></li> <li>The <strong>MOM 2005 to OpsMgr 2007 Migration tool</strong></li></ol> <p>This worked perfectly for me, and I never experience the above error.</p> <p>Once everything is installed, you can begin the conversion process.&nbsp; Open <strong>Start</strong> --&gt; <strong>All Programs</strong> --&gt; <strong>System Center Operations Manager 2007</strong> --&gt;<strong> Migration Tool</strong>.&nbsp; The migration tool is a wizard that will walk you through the process, and is very easy.&nbsp; Simply point to the extracted 2005 management pack file (which you can <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=20ac6a26-02cc-4dee-95e5-39ee6dabd751&amp;DisplayLang=en">download here</a>) and either migrate it directly to your OpsMgr group or to a file.</p> <p>If you have chosen to migrate it to file (like I did), you must then import it into OgsMgr 2007.&nbsp; Open <strong>Start</strong> --&gt; <strong>All Programs</strong> --&gt; <strong>System Center Operations Manager 2007</strong> --&gt;<strong> Operations Console</strong>, choose the <strong>Administration</strong> tab, right-click <strong>Device Management</strong>, select <strong>Import Management Packs</strong>, and point to your converted MOM pack.&nbsp; It's as easy as that!</p> <p>Now when you go to the Monitoring tab, you'll see the following:</p> <p><a href="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ConvertingtheCommerceServer2007MOMPackto_C74C/CSMonitoring_2.gif"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="297" alt="Commerce Server 2007 Monitoring" src="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ConvertingtheCommerceServer2007MOMPackto_C74C/CSMonitoring_thumb.gif" width="273" border="0"></a> </p> <p>All you need to do now is provision the agents on your Commerce Server 2007 machine, and away you go!&nbsp; Very simple, and very useful.</p> <p>I hope this helps!</p><a href="http://images.wadewegner.com/wordpress/content/binary/Microsoft_Commerce_Server_2007.XML">Microsoft_Commerce_Server_2007.XML (2.18 MB)</a>
