--- 
layout: post
title: "Warning: the CID values for both test machines are the same"
categories: 
- BizTalk Server
- Tools
- Troubleshooting
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/9Eq2cV
  _sexybookmarks_permaHash: 5c9e11d5785ba32bd8c2df971ac3b678
  dsq_thread_id: "609464925"
---
<p>I came across a <strike>frustrating</strike> interesting problem today where the BizTalk Server 2006 Configuration wizard would fail every time I applied a new configuration.</p> <p>Unlike a typical BizTalk developer environment (which usually consists of BizTalk and SQL Server on the same machine), this environment consisted of two separate machines: one BizTalk Server 2006 and one SQL Server 2005 (i.e. the BizTalk databases are stored on the SQL Server).&#160; Additionally, this is a virtual environment and both machines were cloned from the same base Windows Server 2003 R2 template.</p> <p>I was installing the following components ...</p> <ul> <li>Enterprise Single Sign-On (SSO) </li> <li>Group </li> <li>BizTalk Runtime </li> <li>MSMQT </li> </ul> <p>It would successfully install ENTSSO, but would fail when installing the group.&#160; The log file reported the following error:</p> <blockquote> <p>Failed to configure with error message [Exception of type 'System.EnterpriseServices.TransactionProxyException' was thrown.]</p> </blockquote> <p>The following <a href="http://www.google.com/search?hl=en&amp;rls=com.microsoft%3Aen-us%3AIE-SearchBox&amp;rlz=1I7GGIG&amp;q=biztalk+Exception+of+type+%27System.EnterpriseServices.TransactionProxyException%27+was+thrown.">Google search</a> suggested to me that&#160; the underlying problem was with MSDTC (<em>aren't all BizTalk problems?</em>).&#160; I checked, and double-checked, the MSDTC properties on both servers and couldn't find anything wrong with the configuration.&#160; So, I had to pull out the big guns.</p> <p>I downloaded <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=5e325025-4dcd-4658-a549-1d549ac17644&amp;DisplayLang=en">DTCPing</a> (a very handy tool for debugging DTC issues) and ran it on both machines (make sure to read the instructions on how to use DTCPing as it is not straightforward).&#160; In the generated log file I noticed the following warning:</p> <blockquote> <p>WARNING: the CID values for both test machines are the same while this problem won't stop DTCping test, MSDTC will fail for this ...</p> </blockquote> <p>A <a href="http://www.google.com/search?sourceid=navclient&amp;ie=UTF-8&amp;rlz=1T4GGIG_enUS227US227&amp;q=the+CID+values+for+both+test+machines+are+the+same+">Google search</a> on this warning helped me to understand that the underlying problem is that the CID values stored for MSDTC were not changed during the cloning process.&#160; But of course!</p> <p>If you're experiencing this problem, check the following registry key on both of your machines.&#160; Are the keys identical?</p> <blockquote> <p>HKEY_CLASSES_ROOTCID</p> </blockquote> <p>Mine were.&#160; Here's the steps I took successfully reinstall MSDTC so that the CID values were unique.&#160; Run this procedure on both machines:</p> <ol> <li>Use Add Windows Components, and remove Network DTC.      <br /> </li> <li>Go to the command line and run: MSDTC -uninstall      <br /> </li> <li>Go to the registry and delete the MSDTC keys in HKLM/Software/Microsoft/Software/MSDTC, HKLM/System/CurrentControlSet/Services/MSDTC, and HKEY_CLASSES_ROOTCID (if they're still there).      <br /> </li> <li>Reboot      <br /> </li> <li>Go to the command line and run: MSDTC -install      <br /> </li> <li>Use Add Windows Components, and add Network DTC.      <br /> </li> <li>Go to the command line and run: net start msdtc </li> </ol> <p>After running this on both servers I was able to confirm that the CID values were unique.&#160; And, sure enough, when I next applied my configuration to BizTalk Server 2006 everything worked perfectly.</p> <p>I hope this helps!</p>
