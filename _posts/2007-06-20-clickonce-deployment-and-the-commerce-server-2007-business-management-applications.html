--- 
layout: post
title: ClickOnce Deployment and the Commerce Server 2007 Business Management Applications
categories: 
- .NET 2.0
- Commerce Server
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/dlsPpz
  _sexybookmarks_permaHash: fa8d36d941033e974e26e224e9d6bf26
  dsq_thread_id: "610834296"
---
<p>As a Commerce Server developer, you are bound to come across a situation where the&nbsp;smart client business user applications&nbsp;(e.g. the Catalog Manager, Catalog and Inventory Schema Manager, Customer and Orders Manager, and Marketing Manager)&nbsp;do not satisfy a business requirement,&nbsp;need to reflect&nbsp;a company's brand or style,&nbsp;or your business users simply want it changed.</p> <p>Fortunately, you can get the full C# source code for the&nbsp;business user applications (except for the Catalog and Inventory Schema&nbsp;Manager; see <a href="http://blogs.msdn.com/maxakbar/" target="_blank">Max's</a> comment in <a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1141608&amp;SiteID=1" target="_blank">this thread</a>) through the&nbsp;<a href="http://www.microsoft.com/commerceserver/partners/sdk/default.mspx" target="_blank">Commerce Server 2007 Partner SDK</a>.&nbsp; This gives you the ability to modify the business user applications and be a hero to all your colleagues and clients (chuckle!).</p> <p>Yeah, yeah, this is all old news.&nbsp; However, I just came across a great idea from&nbsp;<a href="http://www.publicvoid.dk/default.aspx" target="_blank">Søren Spelling Lund</a>&nbsp;in which he talks about his experiences using ClickOnce Deployment along with the business user applications.</p> <h3>What is ClickOnce Deployment?</h3> <p><a href="http://msdn2.microsoft.com/en-us/library/t71a733d(VS.80).aspx" target="_blank">ClickOnce deployment</a> is a technology designed to ease the difficulty in creating self-updating Windows-based applications.&nbsp; Using the Publish Wizard in Visual Studio 2005 (or mage.exe, mageui.exe, or MSBuild), you can publish your application in three different ways: to media (such as a CD-ROM), to a network file share, or to a Web page.</p> <p>When an application is published, two files are created: an application manifest, and a deployment manifest.&nbsp; The application manifest describes the contents of&nbsp; the application, including the assemblies, dependencies, and the files that make up the application.&nbsp; The deployment manifest describes how the application is deployed, the location of the application manifest, and the version of the application that should be run by the clients.</p> <p>Here's an example of an application published to a Web page (this particular example is from the SpaceWar SDK for the XNA framework - yes, I truly aspire to be an <a href="http://msdn2.microsoft.com/en-us/xna/default.aspx" target="_blank">XBOX 360 game developer</a>):</p> <p><a href="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ClickOnceDeploymentoftheCommerceServer20_DCB4/ClickOnce.gif" atomicselection="true"><img height="317" alt="Example of application published to a Web page via ClickOnce" src="http://images.wadewegner.com/wordpress/content/binary/WindowsLiveWriter/ClickOnceDeploymentoftheCommerceServer20_DCB4/ClickOnce_thumb.gif" width="587"></a> </p> <p>(Note the deployment version number.)</p> <p>Once the end-user installs the application from the deployment location, the application is, by default, added to the Start menu and the Add/Remove programs group in the Control Panel.&nbsp; <strong>Nothing is added to the Program Files folder, the registry, or the desktop.</strong>&nbsp; When I first played around&nbsp;with ClickOnce this last part caught me unaware -- I couldn't figure out where my application had been installed!&nbsp; Also, no administrative rights are required to install the application.</p> <p>Now, remember the deployment version number?&nbsp; The best part about this technology is that, if a developer publishes a new version of the application, the deployment version number is incremented.&nbsp; Consequently, the next time the end-user runs the application they are <strong>presented with an opportunity to update their application</strong>.&nbsp; What's neat is that, as a developer, you actually have a lot of control: you can require an update, and you can even require that a user rolls back to an earlier version of the application (not that any of us would ever have to roll back to an earlier version ...).</p> <p>All-in-all, it's neat stuff.&nbsp; And, while it's not a perfect solution and <a href="http://www.google.com/search?hl=en&amp;rlz=1T4GGIG_enUS227US227&amp;q=clickonce+problems" target="_blank">has it's own problems</a>, you can very rapidly integrate it into your application and quickly reap the rewards.&nbsp; Oh, and you can easily become a hero to your colleagues and clients (are you starting to sense a pattern?).</p> <h3>Integrate ClickOnce Deployment into the Partner SDK?</h3> <p>So, we're back to the smart client business user applications.&nbsp; I'm sure you're now asking yourself, what does this have to do with the Commerce Server 2007 business user applications (or maybe not, since I alluded to it above)?</p> <p><a href="http://www.publicvoid.dk/default.aspx" target="_blank">Søren Spelling Lund</a>&nbsp;posted an article about integrating ClickOnce Deployment into the business user applications.&nbsp; It's a great idea, and one I will definitely use in the future.&nbsp; Additionally, he takes the time to point out a problem him and his colleagues ran into when they tried to run the ClickOnce installer on the Customer and Orders Manager.&nbsp; Essentially, it appears that the project file included a &lt;TargetZone&gt; element that interfered with the ClickOnce installer.&nbsp; Removing the &lt;TargetZone&gt; element resolved the problem.&nbsp; Check out <a href="http://www.publicvoid.dk/ClickOnceDeploymentOfCommerceServer2007BusinessTools.aspx" target="_blank">his blog article</a> for the full details.</p> <p>What are the benefits of integrating ClickOnce Deployment into the Partner SDK?</p> <ul> <li>Ease -&nbsp;Easily deployment of business user applications to end-users</li> <li>Versioning - Make sure your end-users are running the latest and greatest</li> <li>Safety - The ability to roll back to a previous version of the application (just in case!)</li> <li>Security - The applications run in a security context that prevents users from doing malicious things</li> <li>Fame - Yes, you too can be a hero ...</li></ul> <p>Thanks to Søren for a great idea and a great post!</p> <p>What great ideas have you put into play?&nbsp; Please let me know!</p>
