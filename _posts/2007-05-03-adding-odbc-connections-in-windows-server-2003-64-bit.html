--- 
layout: post
title: Adding ODBC connections in Windows Server 2003 64-bit
categories: 
- BizTalk Server
- Windows Server 2003
- x64
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/czpZnQ
  _sexybookmarks_permaHash: e420b8dad1107e96d9f84d6282855d1c
  dsq_thread_id: "609465035"
---
<p></p>  <p>We've been deploying a BizTalk 2006 solution to a x64 system and, while BizTalk 2006 itself has no problems, I've had a lot of problems related to the BizTalk Adapters for Host Systems and the BizTalk Adapters for Enterprise Applications.&#160; I plan to write a number of posts in the near future discussing these problems (once we have them all resolved).&#160; In the meantime, I wanted to share this little tidbit I've learned about ODBC on 64-bit windows.</p>  <p>It's important for you to know if your application is going to run as a 32-bit or 64-bit application.&#160; There are two different repositories for ODBC connections, based on the drivers you've installed and the client that will run them.&#160; 32-bit applications will only see ODBC connections from the 32-bit side, and 64-bit applications will only see ODBC connections from the 64-bit side.</p>  <p>32-bit applications register ODBC connections to the following registry key:</p>  <blockquote style="margin-right: 0px" dir="ltr">   <p>HKEY_LOCAL_MACHINESOFTWAREWow6432NodeODBCODBC.INI</p> </blockquote>  <p>64-bit applications register ODBC connections to the following registry key:</p>  <blockquote style="margin-right: 0px" dir="ltr">   <p>HKEY_LOCAL_MACHINESOFTWAREODBCODBC.INI</p> </blockquote>  <p>Adding these keys is initially tricky, but if you understand the above then it should make sense.&#160; Typically, you go to Start --&gt; Administrative Tools --&gt; Data Sources (ODBC) to create your ODBC connections.&#160; And this is fine if you want to create 64-bit ODBC connections.&#160; Any ODBC connection created using the Data Sources (ODBC) link will get created in the HKEY_LOCAL_MACHINESOFTWAREODBCODBC.INI key.&#160; This is because it calls the program %WINDIR%System32odbcad32.exe.&#160; However, this program will not create 32-bit ODBC connections.</p>  <p>To create 32-bit ODBC connections, you have to run %WINDIR%SysWOW64odbcad32.exe.&#160; Adding an ODBC connection through this application will create the ODBC connection in the HKEY_LOCAL_MACHINESOFTWAREWow6432NodeODBCODBC.INI key, and allow your 32-bit applications to see and use the ODBC connection.</p>  <p>I'm still getting used to the concept of WOW and how it runs 32-bit applications on an x64 system.&#160; This information may not be news to some of you, but it presented a challenge to me.</p>  <p>I hope this helps!</p>
