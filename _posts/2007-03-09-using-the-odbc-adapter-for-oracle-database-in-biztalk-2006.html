--- 
layout: post
title: Using the "ODBC Adapter for Oracle Database" in BizTalk 2006
categories: 
- BizTalk Server
tags: []

status: publish
type: post
published: true
meta: 
  _edit_last: "1"
  _sexybookmarks_shortUrl: http://bit.ly/cwrZwi
  _sexybookmarks_permaHash: 852845e74744168b7320d0358f057cb9
  dsq_thread_id: "609465902"
---
<p>Having used the "Microsoft BizTalk Adapters for Host Systems" to connect to a DB2 back-end, I thought I was ready for any adapter challenge.&nbsp; Turns out that using the "Microsoft BizTalk Adapters for Enterprise Applications" to connect to Oracle was a little trickier than I thought it would be.</p>
<p>To start, I couldn't figure out where to find the Oracle adapter!&nbsp; If you read the BizTalk 2006 Pricing and Licensing page (<a href="http://www.microsoft.com/biztalk/howtobuy/default.mspx">http://www.microsoft.com/biztalk/howtobuy/default.mspx</a>) you'll see that "ODBC Adapter for Oracle Database" is included in the license!&nbsp; To me that insinuates no additional installation or download is required, but that's not the case.&nbsp; There are actually two prerequisites to using the Oracle adapter.</p>
<p>First, you need the Oracle client installed on your machine.&nbsp; Yes, in retrospect, this seems perfectly obvious (but, in hindsight, what isn't?).&nbsp; Second, you need to acquire a copy of "Microsoft BizTalk Adapters for Enterprise Applications" and install the "Microsoft BizTalk Adapter for Oracle(r) Database".</p>
<p>With regards to the Oracle client, there is a good article on MSDN (also found in the help documentation) that will walk you through the installation and configuration of the Oracle client (<a href="http://msdn2.microsoft.com/en-us/library/aa547634.aspx">http://msdn2.microsoft.com/en-us/library/aa547634.aspx</a>).&nbsp; I recommend using this tutorial.&nbsp; The installation for the "Microsoft BizTalk Adapters for Enterprise Applications" is straightforward, and shouldn't give you any problems.</p>
<p>Once the two of these applications are installed (and you've registered the appropriate TNS names for Oracle connectivity), you must create&nbsp;an ODBC connection.&nbsp; To do this, do the following:</p>
<ol>
<li>Administrative Tools -&gt; Data Sources (ODBC)
<li>Click the System DSN tab, followed by Add
<li>Select "Oracle in OraHome92" (yours may be slightly different)
<li>You'll now have to configure your ODBC connection.&nbsp; Make sure to specify the Data Source Name, the TNS Service Name, and the User ID.&nbsp; When you click "Test Connection" you will be prompted for the password.&nbsp; Make sure the test passes.
<li>Click "OK", and "OK" to exit.</li></ol>
<p>Now that the ODBC connection is created, we have to setup the Oracle adapter in the BizTalk Administrative Console.&nbsp; Under the BizTalk Group, expand "Platform Settings" and "Adapters".&nbsp; Notice that there isn't an Oracle adapter.&nbsp; You'll have to right-click on "Adapters" and choose "New" --&gt; "Adapter...".&nbsp; From here you can choose the "Oracle(r) Database" adapter, and specify a name.&nbsp; I like "OracleDB".&nbsp; The default Host will be added automatically for both Send and Receive.</p>
<p>Now that all the prerequisites are out of the way, we have to go about first creating a receive port/location or a send port.&nbsp; Now, in my experience, this is somewhat backwards.&nbsp; Typically I first choose "Add Generated Item", "Add Adapter Metadata", and then select the adapter I want to use.&nbsp; With Oracle, you must first create your Receive Port/Location or Send Port, and then use it to define your schema.</p>
<p>Here's the process I use to create a Recieve Port/Location</p>
<ol>
<li>Open the "BizTalk Administration Console" (I'm not a big fan of doing this in Visual Studio 2005)
<li>Create a new Receive Port (let's do One-Way for simplicity), and call it "ReceiveDataFromOracleDB"
<li>Create a new One-way Receive Location on the "ReceiveDataFromOracleDB" port.&nbsp; Specify a decent name -- "ReceiveDataFromOracleDB-ORA" isn't the best, but will do
<li>Select the "OracleDB" adapter you defined earlier, and click "Configure".&nbsp; Specify the following values
<ol>
<li>Password
<li>PATH -- with a default installation of Oracle, this would be "C:Oracleora92bin" (yours may be slightly different)
<li>Service name -- this is the ODBC connection you created
<li>User name</li></ol>
<li>At this point I'd recommend not specifying anything else, and clicking okay.&nbsp; This will save the settings, and allow you to continue forward.&nbsp; Having clicked okay, go ahead and immediately click "Configure" again to return to the properties.
<li>Click "Managing Events".&nbsp; This will call the Oracle Adapter Wizard, and confirm that you have correctly configured everything.&nbsp; If you are unable to browse the Oracle database, then you have made a mistake somewhere along the way.&nbsp; Click OK or Cancel to exit.</li></ol>
<p>At this point, just leave your Receive Location alone.&nbsp; The next step will be to use the Receive Port/Location to generate a schema of an Oracle table or stored procedure.</p>
<p>Enter into Visual Studio 2005, and load your BizTalk project (I won't explain how to do this -- if you don't already have one, then create one).&nbsp; A a new item, choose "Add Generated Items ...", then select "Add Adapter Metadata".&nbsp; This will invoke the "Add Adapter Wizard".&nbsp; Select "Oracle(r) Database" from the list of registered adapters, then choose your receive location in the "Port:" dropdown list.&nbsp; Click Next.&nbsp; You will now have the ability to browse the Oracle database, and choose either your stored procedure or table.&nbsp; For simplicity sake, we'll choose a table.&nbsp; The adapter will generate the schemas required to actually retrieve data from the Oracle table.&nbsp; Build your project and deploy.</p>
<p>Once deployed, you can perform the final steps to this process.&nbsp; Go back to your Receive Location, and click the Configure button.&nbsp; Once again, click "Managing Events".&nbsp; This time, choose the same table that you specified in the adapter wizard.&nbsp; Click OK.&nbsp; Now, create a Send Port that uses the File adapter, and subscribe to the Receive Port (this is, in my opinion, the easiest way to test).</p>
<p>If everything has been done correctly, you should see XML files dump into your folder.&nbsp; If they don't, then look into the application log and try to figure out what the problem is.&nbsp; Sadly, that's beyond the scope of this post.</p>
<p>I hope this has helped.&nbsp; Please let me know if I've missed anything.</p>
<p>Best of luck!</p>
