--- 
layout: post
title: Using the .NET Framework 4.0 with the Azure AppFabric SDK
categories: 
- .NET 4.0
- Azure AppFabric
tags: []

status: publish
type: post
published: true
meta: 
  _sexybookmarks_shortUrl: http://bit.ly/cgCM4S
  _sexybookmarks_permaHash: 9e6cdb13c65c8e30f532df71342ea7e8
  _edit_last: "1"
  disable_wpautop: "1"
  disable_wptexturize: "0"
  disable_convert_chars: "0"
  disable_convert_smilies: "0"
  dsq_thread_id: "609466487"
---
<p>The other day I attempted to build a sample application that communicated with the <a href="http://www.microsoft.com/windowsazure/appfabric/" target="_blank">Azure AppFabric</a> Service Bus by creating a Console application targeting the .NET Framework 4.0.&#160; After adding a reference to <font face="Courier New"><strong>Microsoft.ServiceBus</strong></font> I was bewildered to see that my Service Bus bindings in the <font face="Courier New"><strong>system.ServiceModel</strong></font> section were not recognized.</p>  <p>I soon realized that the issue was the machine.config file.&#160; When you install the Azure AppFabric SDK the relevant WCF extensions are added to the .NET Framework 2.0 machine.config file, which is shared by .NET Framework 3.0 and 3.5.&#160; However, .NET Framework 4.0 has its own machine.config file, and the SDK will not update the WCF extensions.</p>  <p>Fortunately, there’s an easy solution to this issue: use the CLR’s <font face="Courier New"><strong>requiredRuntime</strong></font> feature.</p>  <ol>   <li>Create a configuration file named <strong>RelayConfigurationInstaller.exe.config</strong> in the “C:%Program Files%Windows Azure platform AppFabric SDKV1.0Assemblies” folder with the following code:      <br />      <br />      <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:9ce6104f-a9aa-4a17-a79f-3a39532ebf7c:0337ad9f-0a21-4178-ad34-756076769120" class="wlWriterEditableSmartContent"> <div class="le-pavsc-container"> <div class="le-pavsc-titleblock">Code Snippet</div> <div style="background: #ddd; overflow: auto"> <ol style="background: #ffffff; margin: 0 0 0 2em; padding: 0 0 0 5px;"> <li><span style="color:#0000ff">&lt;?</span><span style="color:#a31515">xml</span><span style="color:#0000ff"> </span><span style="color:#ff0000">version</span><span style="color:#0000ff"> =</span>&quot;<span style="color:#0000ff">1.0</span>&quot;<span style="color:#0000ff">?&gt;</span></li> <li class="even"><span style="color:#0000ff">&lt;</span><span style="color:#a31515">configuration</span><span style="color:#0000ff">&gt;  </span></li> <li><span style="color:#0000ff">&lt;</span><span style="color:#a31515">startup</span><span style="color:#0000ff">&gt;    </span></li> <li class="even">    <span style="color:#0000ff">&lt;</span><span style="color:#a31515">requiredRuntime</span><span style="color:#0000ff"> </span><span style="color:#ff0000">safemode</span><span style="color:#0000ff">=</span>&quot;<span style="color:#0000ff">true</span>&quot;<span style="color:#0000ff"> </span><span style="color:#ff0000">imageVersion</span><span style="color:#0000ff">=</span>&quot;<span style="color:#0000ff">v4.0.30319</span>&quot;<span style="color:#0000ff"> </span><span style="color:#ff0000">version</span><span style="color:#0000ff">=</span>&quot;<span style="color:#0000ff">v4.0.30319</span>&quot;<span style="color:#0000ff">/&gt;  </span></li> <li><span style="color:#0000ff">&lt;/</span><span style="color:#a31515">startup</span><span style="color:#0000ff">&gt;</span></li> <li class="even"><span style="color:#0000ff">&lt;/</span><span style="color:#a31515">configuration</span><span style="color:#0000ff">&gt;</span></li> </ol> </div> </div> </div>      <br /></li>    <li>Open up an elevated Visual Studio 2010 Command Prompt, browse to the directory, and run: <font face="Courier New"><strong>RelayConfigurationInstaller.exe/ i</strong></font> </li> </ol>  <p>Your .NET Framework 4.0 machine.config file will now have the required configuration settings for the Service Bus bindings.&#160; Thanks to Vishal Chowdhary for the insight!</p>
